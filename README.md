# Simulation Metamodeling with Neural Networks
This repository is dedicated to the work done in connection with my master thesis at Technical University of Denmark. The code is written in [Lightning](https://lightning.ai/docs/pytorch/latest/) and can be made compatible to run on GPU but this is not implemented currently.

The project concerns the use of neural networks in simulation metamodeling. More specifically, it custom neural networks that can fit higher-order polynomials and generalize to unseen inputs. Neural network architectures Polynomial Activation Neural Network (PANN), Coupled decomposition (CCP) from the [$\Pi$-Nets paper](https://arxiv.org/abs/2006.13026) [(Github)](https://github.com/grigorisg9gr/polynomial_nets), PDC from [Augmenting Deep Classifiers with Polynomial Neural Networks](https://arxiv.org/pdf/2104.07916.pdf) and PDCLow based on PDC.

## Installing
To install this project and run it on your own machine, please do the following:
1. Install dependencies - Use one of the two below
    - *environment.yaml* (requires conda) - `conda env create -f environment.yml`
    - *requirements.txt* - `pip install -r requirements.txt` (please use Python 3.10)
2. Install `setup.py` to ensure proper imports.
    - `pip install -e .`

## Folder Structure
The folder structure of this repository does not follow a conventional 

```
├── .vscode
├── data
├── models
├── notebooks
├── scripts
├── training
├── utils
├── .gitignore
├── environment.yml
├── README.md
├── requirements.txt
└── setup.py
```

## Example runs

## Logging
Logging is done with Tensorboard through Lightning. Lightning automatically creates a `tb_logs` folder the Tensorboard log files. To view finished and running runs, use the following command:
```
tensorboard --logdir=tb_logs/
```

The Jupyter Notebook [result_calculation.ipynb](https://github.com/jesperhauch/polynomial_deep_learning/blob/master/result_calculation.ipynb) also shows how to extract the values from the `.tfevents` files generated by the Tensorboard logger in Lightning.